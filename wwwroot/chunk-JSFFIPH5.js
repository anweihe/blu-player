import{b as K,e as J}from"./chunk-EPFU5PDM.js";import"./chunk-5GC77CUC.js";import"./chunk-QC44KA67.js";import{a as q}from"./chunk-O66JSED4.js";import"./chunk-NROGR6IW.js";import{k as Q,l as z}from"./chunk-N35TVY3C.js";import{a as G}from"./chunk-GT7YEPYQ.js";import{$b as $,Ab as D,Bb as d,Cb as P,Db as w,Fa as L,Ga as F,Ja as s,N as V,Nb as T,S as h,Va as j,X as x,Y as _,Z as p,_ as g,db as u,eb as m,ec as N,gb as k,hb as M,ia as S,ib as E,j as f,ja as B,jb as n,kb as r,lb as c,pb as v,rb as b,tb as l,v as I,vb as A,wb as U,xb as H,y as C,yb as O}from"./chunk-TWVQ6WYG.js";var R=class i{http=h(N);getMenu(t){return this.http.get(`/api/RadioParadise?handler=Menu&playerIp=${encodeURIComponent(t.ipAddress)}&port=${t.port||11e3}`).pipe(C(e=>(console.error("Failed to get Radio Paradise menu:",e),f({success:!1,sections:[],hasMultipleSections:!1,error:"Radio Paradise konnte nicht geladen werden"}))))}playChannel(t,e){let o=e.actionUrl||e.actionUri;if(!o)return f({success:!1,error:"Keine Play-URL vorhanden"});let a={ip:t.ipAddress,port:t.port||11e3,playUrl:o,title:e.title,imageUrl:e.imageUrl};return this.http.post("/api/RadioParadise?handler=PlayStation",a).pipe(C(y=>(console.error("Failed to play Radio Paradise channel:",y),f({success:!1,error:"Kanal konnte nicht abgespielt werden"}))))}getBluesoundStatus(t){return this.http.get(`/api/RadioParadise?handler=BluesoundStatus&ip=${t.ipAddress}&port=${t.port||11e3}`).pipe(C(e=>(console.error("Failed to get Bluesound status:",e),f({success:!1,error:"Status konnte nicht abgerufen werden"}))))}controlPlayback(t,e){return this.http.post("/api/RadioParadise?handler=BluesoundControl",{ip:t.ipAddress,port:t.port||11e3,action:e}).pipe(C(()=>f({success:!1})))}saveToHistory(t,e){let o=e.actionUrl||e.actionUri;return o?this.http.post("/api/RadioParadise?handler=SaveHistory",{profileId:t,title:e.title,imageUrl:e.imageUrl,actionUrl:o,quality:e.subtitle}).pipe(C(()=>f({success:!1}))):f({success:!1})}static \u0275fac=function(e){return new(e||i)};static \u0275prov=V({token:i,factory:i.\u0275fac,providedIn:"root"})};var Y=["playerSelector"],Z=(i,t)=>t.title||i,ee=(i,t)=>t.title;function te(i,t){if(i&1){let e=v();n(0,"button",17),b("click",function(){x(e);let a=l();return _(a.openProfileSwitcher())}),d(1),r()}if(i&2){let e=l();O("background-color",e.profileService.activeProfile()?e.profileService.getProfileColor(e.profileService.activeProfile().id):"rgb(16 185 129)"),s(),w(" ",e.profileInitial()," ")}}function ie(i,t){if(i&1){let e=v();n(0,"app-profile-switcher",18),b("closed",function(){x(e);let a=l();return _(a.closeProfileSwitcher())})("profileSelected",function(a){x(e);let y=l();return _(y.onProfileSelected(a))}),r()}}function ne(i,t){if(i&1){let e=v();n(0,"div",16)(1,"div",19),p(),n(2,"svg",20),c(3,"rect",21)(4,"circle",22)(5,"path",23),r()(),g(),n(6,"h2",24),d(7,"Bluesound Player erforderlich"),r(),n(8,"p",25),d(9," Radio Paradise verwendet die integrierte Radio-Funktion deines Bluesound Players. Bitte w\xE4hle einen Player aus. "),r(),n(10,"button",26),b("click",function(){x(e);let a=l();return _(a.openPlayerSelector())}),d(11," Player ausw\xE4hlen "),r()()}}function re(i,t){i&1&&(n(0,"div",33)(1,"div",35),c(2,"div",36),n(3,"span",37),d(4,"Laden..."),r()()())}function oe(i,t){if(i&1){let e=v();n(0,"div",16)(1,"div",38),p(),n(2,"svg",39),c(3,"circle",40)(4,"line",41)(5,"line",42),r()(),g(),n(6,"p",43),d(7),r(),n(8,"button",44),b("click",function(){x(e);let a=l(2);return _(a.loadChannels())}),d(9," Erneut versuchen "),r()()}if(i&2){let e=l(2);s(7),P(e.error())}}function ae(i,t){if(i&1&&(n(0,"span",50),d(1),r()),i&2){let e=l(2).$implicit,o=l(3);D(o.getQualityBadgeClass(e.title)),s(),w(" ",o.getQualityBadge(e.title)," ")}}function le(i,t){if(i&1&&(n(0,"div",45)(1,"h3",48),d(2),r(),u(3,ae,2,3,"span",49),r()),i&2){let e=l().$implicit,o=l(3);s(2),w(" ",e.title," "),s(),m(o.getQualityBadge(e.title)?3:-1)}}function se(i,t){if(i&1&&c(0,"img",53),i&2){let e=l().$implicit;E("src",e.imageUrl,F)}}function de(i,t){if(i&1&&(n(0,"div",54),p(),c(1,"svg",62),r()),i&2){let e=l().$implicit,o=l(4);s(),E("innerHTML",o.getChannelIconPath(e.title),L)}}function ce(i,t){if(i&1&&(n(0,"p",57),d(1),r()),i&2){let e=l().$implicit;s(),P(e.subtitle)}}function pe(i,t){if(i&1){let e=v();n(0,"button",51),b("click",function(){let a=x(e).$implicit,y=l(4);return _(y.playChannel(a))}),n(1,"div",52),u(2,se,1,1,"img",53)(3,de,2,1,"div",54),r(),n(4,"div",55)(5,"h4",56),d(6),r(),u(7,ce,2,1,"p",57),r(),n(8,"div",58)(9,"div",59),p(),n(10,"svg",60),c(11,"path",61),r()()()()}if(i&2){let e=t.$implicit;s(2),m(e.imageUrl?2:3),s(4),P(e.title),s(),m(e.subtitle?7:-1)}}function ue(i,t){if(i&1&&(n(0,"section"),u(1,le,4,2,"div",45),n(2,"div",46),k(3,pe,12,3,"button",47,ee),r()()),i&2){let e=t.$implicit;s(),m(e.title?1:-1),s(2),M(e.items)}}function me(i,t){if(i&1&&(n(0,"div",34),k(1,ue,5,1,"section",null,Z),r()),i&2){let e=l(2);s(),M(e.currentSections())}}function fe(i,t){i&1&&(n(0,"div",16),p(),n(1,"svg",63),c(2,"path",10)(3,"path",11)(4,"path",12),r(),g(),n(5,"h3",64),d(6,"Keine Kan\xE4le"),r(),n(7,"p",37),d(8,"Radio Paradise konnte nicht geladen werden."),r()())}function he(i,t){if(i&1&&(n(0,"div",27)(1,"div",28)(2,"div",29),p(),n(3,"svg",30),c(4,"path",10)(5,"path",11)(6,"path",12),r()(),g(),n(7,"div")(8,"h2",31),d(9,"Radio Paradise"),r(),n(10,"p",32),d(11,"Eclectic Mix - Listener Supported"),r()()()(),u(12,re,5,0,"div",33)(13,oe,10,1,"div",16)(14,me,3,0,"div",34)(15,fe,9,0,"div",16)),i&2){let e=l();s(12),m(e.isLoading()?12:e.error()?13:e.currentSections().length>0?14:15)}}var W=class i{playerSelector;auth=h(z);profileService=h(Q);rpApi=h(R);playerState=h(q);navState=h(G);showProfileSwitcher=S(!1);profileInitial=T(()=>{let t=this.profileService.activeProfile();return t?this.profileService.getProfileInitial(t.name):this.auth.userInitial()});isLoading=S(!1);error=S(null);currentSections=S([]);isPlaying=S(!1);statusSubscription;previousPlayerId=null;hasBluesoundPlayer=T(()=>{let t=this.playerState.selectedPlayer();return t!==null&&t.ipAddress!==void 0});constructor(){B(()=>{let t=this.playerState.selectedPlayer(),e=t?.id??null;e!==this.previousPlayerId&&t?.ipAddress&&(this.previousPlayerId=e,this.loadChannels())})}ngOnInit(){this.navState.usePreset("hidden"),this.hasBluesoundPlayer()&&this.loadChannels()}openPlayerSelector(){this.playerSelector?.open()}openProfileSwitcher(){this.showProfileSwitcher.set(!0)}closeProfileSwitcher(){this.showProfileSwitcher.set(!1)}onProfileSelected(t){this.profileService.setActiveProfileId(t.id),this.closeProfileSwitcher()}toggleMenu(){this.navState.toggleHamburger()}ngOnDestroy(){this.stopStatusPolling()}loadChannels(){let t=this.playerState.selectedPlayer();t&&(this.isLoading.set(!0),this.error.set(null),this.rpApi.getMenu(t).subscribe({next:e=>{e.success?this.currentSections.set(e.sections):this.error.set(e.error||"Radio Paradise konnte nicht geladen werden"),this.isLoading.set(!1)},error:()=>{this.error.set("Radio Paradise konnte nicht geladen werden"),this.isLoading.set(!1)}}))}playChannel(t){let e=this.playerState.selectedPlayer();e&&this.rpApi.playChannel(e,t).subscribe({next:o=>{if(o.success){this.isPlaying.set(!0),this.startStatusPolling();let a=this.auth.getProfileId();a&&this.rpApi.saveToHistory(a,t).subscribe()}else this.error.set(o.error||"Kanal konnte nicht abgespielt werden")}})}getQualityBadge(t){if(!t)return null;let e=t.toLowerCase();return e.includes("mqa")?"MQA":e.includes("cd")||e.includes("flac")?"FLAC":null}getQualityBadgeClass(t){if(!t)return"";let e=t.toLowerCase();return e.includes("mqa")?"bg-purple-500/20 text-purple-400":e.includes("cd")||e.includes("flac")?"bg-blue-500/20 text-blue-400":""}getChannelIconPath(t){let e=(t||"").toLowerCase();return e.includes("main")?'<path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/>':e.includes("mellow")?'<path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>':e.includes("rock")?'<polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>':e.includes("global")?'<circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>':'<path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/>'}startStatusPolling(){this.stopStatusPolling(),this.playerState.selectedPlayer()&&(this.statusSubscription=I(5e3).subscribe(()=>{let e=this.playerState.selectedPlayer();if(!e){this.stopStatusPolling();return}this.rpApi.getBluesoundStatus(e).subscribe({next:o=>{o.success&&o.status&&this.isPlaying.set(o.status.state==="play"||o.status.state==="stream")}})}))}stopStatusPolling(){this.statusSubscription?.unsubscribe(),this.statusSubscription=void 0}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=j({type:i,selectors:[["app-radio-paradise"]],viewQuery:function(e,o){if(e&1&&A(Y,5),e&2){let a;U(a=H())&&(o.playerSelector=a.first)}},decls:21,vars:3,consts:[["playerSelector",""],[1,"min-h-screen","bg-bg-primary"],[1,"sticky","top-0","z-[60]","bg-bg-secondary","border-b","border-border-subtle","safe-area-top"],[1,"flex","items-center","justify-between","px-4","py-3.5","max-w-5xl","mx-auto"],[1,"flex","items-center","gap-3"],["aria-label","Men\xFC",1,"w-10","h-10","rounded-lg","bg-bg-card","border","border-border-subtle","flex","items-center","justify-center","hover:bg-bg-card-hover","transition-colors",3,"click"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"w-5","h-5","text-text-primary"],["d","M4 6h16M4 12h16M4 18h16","stroke-linecap","round"],[1,"flex","items-center","gap-2.5"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"w-7","h-7","text-emerald-500"],["d","M12 2L2 7l10 5 10-5-10-5z"],["d","M2 17l10 5 10-5"],["d","M2 12l10 5 10-5"],[1,"text-xl","font-semibold","tracking-tight"],[1,"w-9","h-9","rounded-full","text-white","flex","items-center","justify-center","text-sm","font-semibold","cursor-pointer","hover:ring-2","hover:ring-emerald-500/50","transition-all",3,"background-color"],[1,"px-4","py-6","max-w-5xl","mx-auto","pb-28"],[1,"flex","flex-col","items-center","justify-center","py-16","text-center"],[1,"w-9","h-9","rounded-full","text-white","flex","items-center","justify-center","text-sm","font-semibold","cursor-pointer","hover:ring-2","hover:ring-emerald-500/50","transition-all",3,"click"],[3,"closed","profileSelected"],[1,"w-20","h-20","rounded-2xl","bg-bg-card","flex","items-center","justify-center","mb-6"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5",1,"w-10","h-10","text-text-muted"],["x","4","y","4","width","16","height","16","rx","2"],["cx","12","cy","12","r","3"],["d","M12 9v-2M12 17v-2M9 12H7M17 12h-2"],[1,"text-xl","font-bold","mb-2"],[1,"text-text-secondary","mb-6","max-w-sm"],[1,"px-5","py-2.5","bg-emerald-500","text-white","rounded-lg","font-medium","hover:bg-emerald-600","transition-colors",3,"click"],[1,"bg-gradient-to-br","from-emerald-600","to-emerald-800","rounded-2xl","p-4","sm:p-6","mb-8"],[1,"flex","items-center","gap-3","sm:gap-4"],[1,"w-12","h-12","sm:w-16","sm:h-16","rounded-xl","bg-white/10","flex","items-center","justify-center"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5",1,"w-6","h-6","sm:w-8","sm:h-8","text-white"],[1,"text-lg","sm:text-xl","font-bold","text-white"],[1,"text-white/70","text-sm"],[1,"flex","items-center","justify-center","py-16"],[1,"space-y-8"],[1,"flex","flex-col","items-center","gap-4"],[1,"w-10","h-10","border-3","border-emerald-500/30","border-t-emerald-500","rounded-full","animate-spin"],[1,"text-text-secondary"],[1,"w-16","h-16","rounded-full","bg-red-500/10","flex","items-center","justify-center","mb-4"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-8","h-8","text-red-500"],["cx","12","cy","12","r","10"],["x1","15","y1","9","x2","9","y2","15"],["x1","9","y1","9","x2","15","y2","15"],[1,"text-red-400","mb-4"],[1,"px-4","py-2","bg-bg-card","text-text-primary","rounded-lg","hover:bg-bg-card-hover","transition-colors",3,"click"],[1,"flex","items-center","gap-3","mb-4"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-3"],[1,"flex","items-center","gap-4","p-4","bg-bg-card","border","border-border-accent","rounded-xl","hover:bg-bg-card-hover","hover:border-emerald-500/30","transition-all","group"],[1,"text-sm","font-semibold","text-text-muted","uppercase","tracking-wide"],[1,"px-2","py-0.5","text-xs","font-bold","rounded",3,"class"],[1,"px-2","py-0.5","text-xs","font-bold","rounded"],[1,"flex","items-center","gap-4","p-4","bg-bg-card","border","border-border-accent","rounded-xl","hover:bg-bg-card-hover","hover:border-emerald-500/30","transition-all","group",3,"click"],[1,"w-14","h-14","rounded-lg","bg-emerald-500/10","flex-shrink-0","overflow-hidden"],["loading","lazy",1,"w-full","h-full","object-cover",3,"src"],[1,"w-full","h-full","flex","items-center","justify-center","text-emerald-500"],[1,"flex-1","min-w-0","text-left"],[1,"font-medium","text-text-primary","truncate"],[1,"text-xs","text-text-muted","truncate"],[1,"flex-shrink-0"],[1,"w-11","h-11","rounded-full","bg-emerald-500","flex","items-center","justify-center","opacity-0","group-hover:opacity-100","transition-opacity"],["viewBox","0 0 24 24","fill","currentColor",1,"w-5","h-5","text-white"],["d","M8 5v14l11-7z"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5",1,"w-6","h-6",3,"innerHTML"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5",1,"w-16","h-16","text-text-muted","mb-4"],[1,"text-lg","font-medium","mb-2"]],template:function(e,o){if(e&1){let a=v();n(0,"div",1)(1,"header",2)(2,"div",3)(3,"div",4)(4,"button",5),b("click",function(){return x(a),_(o.toggleMenu())}),p(),n(5,"svg",6),c(6,"path",7),r()(),g(),n(7,"div",8),p(),n(8,"svg",9),c(9,"path",10)(10,"path",11)(11,"path",12),r(),g(),n(12,"h1",13),d(13,"Radio Paradise"),r()()(),u(14,te,2,3,"button",14),r()(),u(15,ie,1,0,"app-profile-switcher"),n(16,"main",15),u(17,ne,12,0,"div",16)(18,he,16,1),r(),c(19,"app-player-selector",null,0),r()}e&2&&(s(14),m(o.auth.isLoggedIn()?14:-1),s(),m(o.showProfileSwitcher()?15:-1),s(2),m(o.hasBluesoundPlayer()?18:17))},dependencies:[$,K,J],styles:[".safe-area-top[_ngcontent-%COMP%]{padding-top:env(safe-area-inset-top,0)}.border-3[_ngcontent-%COMP%]{border-width:3px}"]})};export{W as RadioParadiseComponent};
