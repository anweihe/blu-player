import{a as ie,c as ae,d as pe,f as le,g as ce,h as ue}from"./chunk-NHIHH347.js";import"./chunk-5GC77CUC.js";import{a as se}from"./chunk-FX7WD7QO.js";import{a as M}from"./chunk-O66JSED4.js";import{h as de}from"./chunk-YHMOLQY4.js";import"./chunk-XHV6DCF3.js";import"./chunk-NROGR6IW.js";import{a as Y,d as ee,h as te,i as ne,j as re,l as O}from"./chunk-N35TVY3C.js";import{a as oe}from"./chunk-GT7YEPYQ.js";import{$ as B,$a as $,B as m,H as d,I as L,J as x,Ja as R,K as h,L as W,N as y,Q as V,R as I,Rb as X,S as a,T as H,Va as K,a as F,bb as _,e as E,ea as G,f as g,fc as J,gc as q,ha as z,ia as A,ib as Z,jb as P,kb as w,lb as k,o as u,rb as N,v as j,w as l,x as f,zb as Q}from"./chunk-TWVQ6WYG.js";var he=[{path:"",loadComponent:()=>import("./chunk-6M76XHU2.js").then(e=>e.HomeComponent)},{path:"qobuz",loadChildren:()=>import("./chunk-MB3Z34UT.js").then(e=>e.QOBUZ_ROUTES)},{path:"tunein",loadComponent:()=>import("./chunk-Y6BQGFI7.js").then(e=>e.TuneInComponent)},{path:"radioparadise",loadComponent:()=>import("./chunk-XPV2FHPS.js").then(e=>e.RadioParadiseComponent)},{path:"players",loadComponent:()=>import("./chunk-ODJGIPCT.js").then(e=>e.PlayersComponent)},{path:"settings",loadComponent:()=>import("./chunk-LI7ZQSHH.js").then(e=>e.SettingsComponent)},{path:"**",redirectTo:""}];var ge=(e,r)=>{if(!e.url.includes("/Qobuz")&&!e.url.includes("/api/qobuz"))return r(e);let o=a(O).getAuthHeaders();if(!o["X-Auth-Token"]||e.headers.has("X-Auth-Token"))return r(e);let t=e.clone({setHeaders:o});return r(t)};var U="Service workers are disabled or not supported by this browser",v=class{serviceWorker;worker;registration;events;constructor(r,n){if(this.serviceWorker=r,!r)this.worker=this.events=this.registration=new E(o=>o.error(new h(5601,!1)));else{let o=null,t=new g;this.worker=new E(p=>(o!==null&&p.next(o),t.subscribe(C=>p.next(C))));let s=()=>{let{controller:p}=r;p!==null&&(o=p,t.next(o))};r.addEventListener("controllerchange",s),s(),this.registration=this.worker.pipe(d(()=>r.getRegistration().then(p=>{if(!p)throw new h(5601,!1);return p})));let i=new g;this.events=i.asObservable();let c=p=>{let{data:C}=p;C?.type&&i.next(C)};r.addEventListener("message",c),n?.get(_,null,{optional:!0})?.onDestroy(()=>{r.removeEventListener("controllerchange",s),r.removeEventListener("message",c)})}}postMessage(r,n){return new Promise(o=>{this.worker.pipe(m(1)).subscribe(t=>{t.postMessage(F({action:r},n)),o()})})}postMessageWithOperation(r,n,o){let t=this.waitForOperationCompleted(o),s=this.postMessage(r,n);return Promise.all([s,t]).then(([,i])=>i)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(r){let n;return typeof r=="string"?n=o=>o.type===r:n=o=>r.includes(o.type),this.events.pipe(f(n))}nextEventOfType(r){return this.eventsOfType(r).pipe(m(1))}waitForOperationCompleted(r){return new Promise((n,o)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(f(t=>t.nonce===r),m(1),u(t=>{if(t.result!==void 0)return t.result;throw new Error(t.error)})).subscribe({next:n,error:o})})}get isEnabled(){return!!this.serviceWorker}},we=(()=>{class e{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new g;constructor(n){if(this.sw=n,!n.isEnabled){this.messages=l,this.notificationClicks=l,this.notificationCloses=l,this.pushSubscriptionChanges=l,this.subscription=l;return}this.messages=this.sw.eventsOfType("PUSH").pipe(u(t=>t.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(u(t=>t.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(u(t=>t.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(u(t=>t.data)),this.pushManager=this.sw.registration.pipe(u(t=>t.pushManager));let o=this.pushManager.pipe(d(t=>t.getSubscription()));this.subscription=new E(t=>{let s=o.subscribe(t),i=this.subscriptionChanges.subscribe(t);return()=>{s.unsubscribe(),i.unsubscribe()}})}requestSubscription(n){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(U));let o={userVisibleOnly:!0},t=this.decodeBase64(n.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),s=new Uint8Array(new ArrayBuffer(t.length));for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return o.applicationServerKey=s,new Promise((i,c)=>{this.pushManager.pipe(d(b=>b.subscribe(o)),m(1)).subscribe({next:b=>{this.subscriptionChanges.next(b),i(b)},error:c})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(U));let n=o=>{if(o===null)throw new h(5602,!1);return o.unsubscribe().then(t=>{if(!t)throw new h(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((o,t)=>{this.subscription.pipe(m(1),d(n)).subscribe({next:o,error:t})})}decodeBase64(n){return atob(n)}static \u0275fac=function(o){return new(o||e)(I(v))};static \u0275prov=y({token:e,factory:e.\u0275fac})}return e})(),Se=(()=>{class e{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(n){if(this.sw=n,!n.isEnabled){this.versionUpdates=l,this.unrecoverable=l;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(U));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let n=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:n},n).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new h(5601,!1));let n=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:n},n)}static \u0275fac=function(o){return new(o||e)(I(v))};static \u0275prov=y({token:e,factory:e.\u0275fac})}return e})(),ve=new V("");function Ce(){let e=a(S);if(!("serviceWorker"in navigator&&e.enabled!==!1))return;let r=a(ve),n=a(G),o=a(_);n.runOutsideAngular(()=>{let t=navigator.serviceWorker,s=()=>t.controller?.postMessage({action:"INITIALIZE"});t.addEventListener("controllerchange",s),o.onDestroy(()=>{t.removeEventListener("controllerchange",s)})}),n.runOutsideAngular(()=>{let t,{registrationStrategy:s}=e;if(typeof s=="function")t=new Promise(i=>s().subscribe(()=>i()));else{let[i,...c]=(s||"registerWhenStable:30000").split(":");switch(i){case"registerImmediately":t=Promise.resolve();break;case"registerWithDelay":t=fe(+c[0]||0);break;case"registerWhenStable":t=Promise.race([o.whenStable(),fe(+c[0])]);break;default:throw new h(5600,!1)}}t.then(()=>{o.destroyed||navigator.serviceWorker.register(r,{scope:e.scope,updateViaCache:e.updateViaCache,type:e.type}).catch(i=>console.error(W(5604,!1)))})})}function fe(e){return new Promise(r=>setTimeout(r,e))}function Ee(){let e=a(S),r=a(B),n=!0;return new v(n&&e.enabled!==!1?navigator.serviceWorker:void 0,r)}var S=class{enabled;updateViaCache;type;scope;registrationStrategy};function be(e,r={}){return H([we,Se,{provide:ve,useValue:e},{provide:S,useValue:r},{provide:v,useFactory:Ee},$(Ce)])}var ye={providers:[z(),te(he,ne(),re()),J(q([ge])),be("ngsw-worker.js",{enabled:!X(),registrationStrategy:"registerWhenStable:30000"})]};var T=class e{bluesoundApi=a(se);playerState=a(M);destroy$=new g;pollingSubscription;POLLING_INTERVAL=1e3;isPolling=A(!1);lastPoll=A(null);startPolling(){this.stopPolling(),this.isPolling.set(!0),this.pollingSubscription=j(this.POLLING_INTERVAL).pipe(L(this.destroy$),f(()=>this.playerState.playerMode()==="bluesound"),f(()=>!!this.playerState.selectedPlayer()),d(()=>{let r=this.playerState.selectedPlayer();return r?this.bluesoundApi.getStatus(r.ipAddress):[]}),x(()=>this.lastPoll.set(new Date))).subscribe(r=>{r&&this.playerState.updatePlaybackStatus(r)})}stopPolling(){this.pollingSubscription&&(this.pollingSubscription.unsubscribe(),this.pollingSubscription=void 0),this.isPolling.set(!1)}pollOnce(){let r=this.playerState.selectedPlayer();r&&this.bluesoundApi.getStatus(r.ipAddress).subscribe(n=>{n&&this.playerState.updatePlaybackStatus(n),this.lastPoll.set(new Date)})}refreshPlayers(){this.bluesoundApi.refreshPlayers().subscribe(r=>{this.playerState.players.set(r)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.stopPolling()}static \u0275fac=function(n){return new(n||e)};static \u0275prov=y({token:e,factory:e.\u0275fac,providedIn:"root"})};var D=class e{auth=a(O);playerState=a(M);polling=a(T);navState=a(oe);ngOnInit(){this.auth.authToken()&&this.auth.verifyToken().subscribe()}toggleHamburger(){this.navState.toggleHamburger()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=K({type:e,selectors:[["app-root"]],decls:10,vars:5,consts:[[1,"app-container","min-h-screen","bg-bg-primary"],[3,"toggleMenu"],[3,"closed","externalOpen"],[1,"flex-1","pb-24","overflow-y-auto"]],template:function(n,o){n&1&&(P(0,"div",0)(1,"app-header",1),N("toggleMenu",function(){return o.toggleHamburger()}),w(),P(2,"app-hamburger-menu",2),N("closed",function(){return o.navState.closeHamburger()}),w(),P(3,"main",3),k(4,"router-outlet"),w(),k(5,"app-global-player")(6,"app-now-playing-popup")(7,"app-fab-menu")(8,"app-volume-panel")(9,"app-global-context-menu"),w()),n&2&&(R(2),Z("externalOpen",o.navState.hamburgerOpen()),R(),Q("pt-14",!o.navState.headerConfig().hidden)("header-padding",!o.navState.headerConfig().hidden))},dependencies:[ee,ie,ae,pe,le,ce,ue,de],styles:[".app-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;height:100dvh;overflow:hidden}main[_ngcontent-%COMP%]{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch}main.header-padding[_ngcontent-%COMP%]{padding-top:calc(3.5rem + env(safe-area-inset-top,0))}"]})};Y(D,ye).catch(e=>console.error(e));
