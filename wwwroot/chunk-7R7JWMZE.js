import{a as U}from"./chunk-HRW6X6ES.js";import{a as O}from"./chunk-3PSR7F6U.js";import"./chunk-TB3BYDLV.js";import{e as N,k as $}from"./chunk-3IHUMDY3.js";import{Ab as V,Ja as G,Mb as D,R as S,Sa as p,Ta as u,Ua as A,Va as k,W as _,Wa as E,X as h,Xa as w,Y as m,Ya as t,Z as x,Za as n,_a as s,a as B,b as L,cb as C,eb as g,gb as d,ha as P,lb as M,mb as T,nb as F,ob as l,pb as y,qb as f,rb as H,ta as I,ua as j,v as z,xa as a,xb as q}from"./chunk-NJ7QWJ2J.js";var R=()=>[1,2,3],W=(r,i)=>i.id;function J(r,i){if(r&1&&(t(0,"button",19),l(1),n()),r&2){let e=d();a(),f(" ",e.auth.userInitial()," ")}}function Q(r,i){if(r&1&&(t(0,"span",24),l(1,"\xB7"),n(),t(2,"span")(3,"strong",23),l(4),n(),l(5," Gruppen"),n()),r&2){let e=d(2);a(4),y(e.groupCount())}}function X(r,i){if(r&1&&(t(0,"div",21)(1,"span")(2,"strong",23),l(3),n(),l(4," Player"),n(),p(5,Q,6,1),n()),r&2){let e=d();a(3),y(e.players().length),a(2),u(e.groupCount()>0?5:-1)}}function Y(r,i){r&1&&(t(0,"div",26)(1,"div",30),s(2,"div",31)(3,"div",32),n(),t(4,"div",3),s(5,"div",33),t(6,"div",34),s(7,"div",35)(8,"div",36),n()()())}function Z(r,i){r&1&&(t(0,"div",25),k(1,Y,9,0,"div",26,A),n(),t(3,"div",27),s(4,"div",28),t(5,"span",29),l(6,"Suche nach Playern im Netzwerk..."),n()()),r&2&&(a(),E(q(0,R)))}function ee(r,i){if(r&1){let e=C();t(0,"div",22)(1,"div",37),m(),t(2,"svg",38),s(3,"rect",39)(4,"circle",40)(5,"line",41),n()(),x(),t(6,"h2",42),l(7,"Keine Player gefunden"),n(),t(8,"p",43),l(9," Stellen Sie sicher, dass Ihre Bluesound Player eingeschaltet sind und Sie sich im selben Netzwerk befinden. "),n(),t(10,"button",44),g("click",function(){_(e);let c=d();return h(c.refreshPlayers())}),m(),t(11,"svg",15),s(12,"path",16)(13,"path",17),n(),l(14," Erneut suchen "),n()()}}function te(r,i){r&1&&(m(),s(0,"rect",63)(1,"rect",64))}function ie(r,i){r&1&&(m(),s(0,"rect",65)(1,"circle",66)(2,"circle",67))}function ne(r,i){r&1&&(t(0,"span",57),l(1,"Master"),n())}function re(r,i){if(r&1&&(t(0,"span",59),l(1),n()),r&2){let e=d().$implicit;a(),f(" ",e.channelMode==="left"?"L":"R"," ")}}function oe(r,i){r&1&&(t(0,"div",61),m(),t(1,"svg",68),s(2,"rect",69)(3,"path",70)(4,"path",71),n(),x(),t(5,"span"),l(6,"Fixed Volume"),n()())}function ae(r,i){if(r&1){let e=C();t(0,"div",72),g("click",function(c){return _(e),h(c.stopPropagation())}),t(1,"button",73),g("click",function(){_(e);let c=d().$implicit,b=d(2);return h(b.adjustVolume(c,-5))}),m(),t(2,"svg",74),s(3,"line",75),n()(),x(),t(4,"div",76),s(5,"div",77),n(),t(6,"button",78),g("click",function(){_(e);let c=d().$implicit,b=d(2);return h(b.adjustVolume(c,5))}),m(),t(7,"svg",74),s(8,"line",79)(9,"line",75),n()(),x(),t(10,"span",80),l(11),n()()}if(r&2){let e=d().$implicit;a(5),M("width",e.volume,"%"),a(6),f("",e.volume,"%")}}function le(r,i){r&1&&(t(0,"div",62)(1,"div",81),m(),t(2,"svg",82),s(3,"path",83)(4,"polyline",84),n(),l(5," Aktiver Player "),n()())}function se(r,i){if(r&1){let e=C();t(0,"button",47),g("click",function(){let c=_(e).$implicit,b=d(2);return h(b.selectPlayer(c))}),t(1,"div",48)(2,"div",49)(3,"h3",50),l(4),n(),t(5,"span",51),m(),s(6,"svg",52),l(7),n()(),x(),t(8,"div",3)(9,"div",53),m(),t(10,"svg",54),p(11,te,2,0)(12,ie,3,0),n()(),x(),t(13,"div",55)(14,"div",13)(15,"span",56),l(16),n(),p(17,ne,2,0,"span",57),n(),t(18,"div",58)(19,"span"),l(20),n(),p(21,re,2,1,"span",59),n()()(),t(22,"div",60),p(23,oe,7,0,"div",61)(24,ae,12,3,"div",13),n()(),p(25,le,6,0,"div",62),n()}if(r&2){let e=i.$implicit,o=d(2);T("border-accent-qobuz",o.isSelected(e))("border-border-subtle",!o.isSelected(e))("ring-1",o.isSelected(e))("ring-accent-qobuz",o.isSelected(e))("border-l-4",!0)("border-l-green-500",e.isMaster)("border-l-blue-500",e.isStereoPaired)("border-l-transparent",!e.isMaster&&!e.isStereoPaired),a(4),y(e.name),a(),F(o.getPlayerBadgeClass(e)),a(),w("innerHTML",o.getPlayerBadgeIcon(e),I),a(),f(" ",o.getPlayerBadgeText(e)," "),a(4),u(e.isStereoPaired?11:12),a(5),y(e.name),a(),u(e.isMaster?17:-1),a(3),H("",e.brand," ",e.modelName),a(),u(e.channelMode?21:-1),a(2),u(e.isFixedVolume?23:24),a(2),u(o.isSelected(e)?25:-1)}}function de(r,i){if(r&1&&s(0,"img",90),r&2){let e=d(3);w("src",e.nowPlaying().imageUrl,j)}}function ce(r,i){r&1&&(t(0,"div",91),m(),t(1,"svg",103),s(2,"circle",104)(3,"circle",10),n()())}function me(r,i){if(r&1&&(t(0,"div",95)(1,"div",105),s(2,"div",77),n(),t(3,"div",106)(4,"span"),l(5),n(),t(6,"span"),l(7),n()()()),r&2){let e=d(3);a(2),M("width",e.getProgressPercent(),"%"),a(3),y(e.formatTime(e.nowPlaying().currentSeconds||0)),a(2),y(e.formatTime(e.nowPlaying().totalSeconds||0))}}function pe(r,i){r&1&&(m(),t(0,"svg",100),s(1,"path",107),n())}function ue(r,i){r&1&&(m(),t(0,"svg",100),s(1,"path",108),n())}function xe(r,i){if(r&1&&(t(0,"div",102),l(1),n()),r&2){let e=d(3);a(),f(" ",e.nowPlaying().service," ")}}function ge(r,i){if(r&1){let e=C();t(0,"div",46)(1,"div",85)(2,"h2",86),l(3,"Wiedergabe"),n(),t(4,"span",87),l(5),n()(),t(6,"div",48)(7,"div",88)(8,"div",89),p(9,de,1,1,"img",90)(10,ce,4,0,"div",91),n(),t(11,"div",55)(12,"h3",92),l(13),n(),t(14,"p",93),l(15),n(),t(16,"p",94),l(17),n(),p(18,me,8,4,"div",95),t(19,"div",3)(20,"button",96),g("click",function(){_(e);let c=d(2);return h(c.controlPlayback("previous"))}),m(),t(21,"svg",97),s(22,"path",98),n()(),x(),t(23,"button",99),g("click",function(){_(e);let c=d(2);return h(c.controlPlayback("toggle"))}),p(24,pe,2,0,":svg:svg",100)(25,ue,2,0,":svg:svg",100),n(),t(26,"button",96),g("click",function(){_(e);let c=d(2);return h(c.controlPlayback("next"))}),m(),t(27,"svg",97),s(28,"path",101),n()()(),p(29,xe,2,1,"div",102),n()()()()}if(r&2){let e=d(2);a(5),f(" ",e.selectedPlayer().name," "),a(4),u(e.nowPlaying().imageUrl?9:10),a(4),y(e.nowPlaying().title||"Kein Titel"),a(2),y(e.nowPlaying().artist),a(2),y(e.nowPlaying().album),a(),u(e.nowPlaying().totalSeconds&&e.nowPlaying().totalSeconds>0?18:-1),a(6),u(e.nowPlaying().isPlaying?24:25),a(5),u(e.nowPlaying().service?29:-1)}}function ye(r,i){if(r&1&&(t(0,"div",25),k(1,se,26,29,"button",45,W),n(),p(3,ge,30,8,"div",46)),r&2){let e=d();a(),E(e.players()),a(2),u(e.selectedPlayer()&&e.nowPlaying()?3:-1)}}var K=class r{auth=S($);bluesoundApi=S(U);playerState=S(O);isLoading=P(!0);players=P([]);nowPlaying=P(null);statusSubscription;selectedPlayer=V(()=>this.playerState.selectedPlayer());groupCount=V(()=>this.players().filter(i=>i.isMaster||i.isStereoPaired).length);ngOnInit(){this.loadPlayers()}ngOnDestroy(){this.stopStatusPolling()}loadPlayers(){this.isLoading.set(!0),this.bluesoundApi.getPlayers().subscribe({next:i=>{let e=i.filter(o=>!o.isSecondaryStereoPairSpeaker);this.players.set(e),this.playerState.players.set(e),this.isLoading.set(!1),this.selectedPlayer()&&this.startStatusPolling()},error:()=>this.isLoading.set(!1)})}refreshPlayers(){this.isLoading.set(!0),this.bluesoundApi.refreshPlayers().subscribe({next:i=>{let e=i.filter(o=>!o.isSecondaryStereoPairSpeaker);this.players.set(e),this.playerState.players.set(e),this.isLoading.set(!1)},error:()=>this.isLoading.set(!1)})}selectPlayer(i){this.playerState.selectPlayer(i),this.startStatusPolling(),this.fetchPlaybackStatus()}isSelected(i){return this.playerState.selectedPlayer()?.id===i.id}adjustVolume(i,e){let o=Math.max(0,Math.min(100,i.volume+e));this.bluesoundApi.setVolume(i.ipAddress,o).subscribe({next:()=>{let c=this.players(),b=c.findIndex(v=>v.id===i.id);if(b>=0){let v=[...c];v[b]=L(B({},v[b]),{volume:o}),this.players.set(v)}}})}getPlayerBadgeClass(i){return i.isMaster?"bg-green-500/15 text-green-500":i.isStereoPaired?"bg-blue-500/15 text-blue-500":"bg-zinc-500/15 text-zinc-400"}getPlayerBadgeIcon(i){return i.isMaster?'<rect x="2" y="7" width="6" height="10" rx="1"/><rect x="16" y="7" width="6" height="10" rx="1"/><path d="M8 12h8"/>':i.isStereoPaired?'<rect x="4" y="6" width="6" height="12" rx="1"/><rect x="14" y="6" width="6" height="12" rx="1"/>':'<rect x="6" y="4" width="12" height="16" rx="2"/><circle cx="12" cy="14" r="3"/><circle cx="12" cy="7" r="1"/>'}getPlayerBadgeText(i){return i.isMaster?"Gruppe":i.isStereoPaired?"Stereo":"Einzeln"}controlPlayback(i){let e=this.selectedPlayer();if(!e)return;let o;switch(i){case"toggle":o=this.nowPlaying()?.isPlaying?this.bluesoundApi.pause(e.ipAddress):this.bluesoundApi.play(e.ipAddress);break;case"previous":o=this.bluesoundApi.back(e.ipAddress);break;case"next":o=this.bluesoundApi.skip(e.ipAddress);break}o.subscribe({next:()=>{setTimeout(()=>this.fetchPlaybackStatus(),200)}})}getProgressPercent(){let i=this.nowPlaying();return!i||!i.totalSeconds||i.totalSeconds<=0?0:(i.currentSeconds||0)/i.totalSeconds*100}formatTime(i){let e=Math.floor(i/60),o=Math.floor(i%60);return`${e}:${o.toString().padStart(2,"0")}`}startStatusPolling(){this.stopStatusPolling(),this.statusSubscription=z(2e3).subscribe(()=>{this.fetchPlaybackStatus()})}stopStatusPolling(){this.statusSubscription?.unsubscribe(),this.statusSubscription=void 0}fetchPlaybackStatus(){let i=this.selectedPlayer();if(!i){this.nowPlaying.set(null);return}this.bluesoundApi.getStatus(i.ipAddress).subscribe({next:e=>{e?this.nowPlaying.set({title:e.title,artist:e.artist,album:e.album,imageUrl:e.imageUrl,currentSeconds:e.currentSeconds,totalSeconds:e.totalSeconds,isPlaying:e.state==="play"||e.state==="stream",service:e.service}):this.nowPlaying.set(null)},error:()=>{this.nowPlaying.set(null)}})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=G({type:r,selectors:[["app-players"]],decls:27,vars:6,consts:[[1,"min-h-screen","bg-bg-primary"],[1,"sticky","top-0","z-50","bg-bg-secondary","border-b","border-border-subtle","safe-area-top"],[1,"flex","items-center","justify-between","px-4","py-3.5","max-w-5xl","mx-auto"],[1,"flex","items-center","gap-3"],["routerLink","/",1,"w-9","h-9","rounded-lg","hover:bg-bg-card","flex","items-center","justify-center","text-text-secondary","hover:text-text-primary","transition-colors"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-5","h-5"],["d","M15 19l-7-7 7-7"],[1,"flex","items-center","gap-2.5"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"w-7","h-7","text-text-primary"],["x","4","y","4","width","16","height","16","rx","2"],["cx","12","cy","12","r","3"],["d","M12 9v-2M12 17v-2M9 12H7M17 12h-2"],[1,"text-xl","font-semibold","tracking-tight"],[1,"flex","items-center","gap-2"],[1,"flex","items-center","gap-2","px-3","py-2","bg-bg-card","border","border-border-accent","rounded-lg","text-text-secondary","hover:text-text-primary","hover:bg-bg-card-hover","transition-colors",3,"click","disabled"],["fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["d","M23 4v6h-6M1 20v-6h6"],["d","M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"],[1,"hidden","sm:inline","text-sm"],[1,"w-9","h-9","rounded-full","bg-accent-qobuz","text-white","flex","items-center","justify-center","text-sm","font-semibold"],[1,"px-4","py-6","max-w-5xl","mx-auto","pb-28"],[1,"flex","items-center","gap-2","mb-4","text-sm","text-text-secondary"],[1,"flex","flex-col","items-center","justify-center","py-16","text-center"],[1,"text-text-primary"],[1,"text-text-muted"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"bg-bg-card","border","border-border-subtle","rounded-xl","p-4","animate-pulse"],[1,"flex","items-center","justify-center","gap-3","mt-8","text-text-secondary"],[1,"w-5","h-5","border-2","border-accent-qobuz/30","border-t-accent-qobuz","rounded-full","animate-spin"],[1,"text-sm"],[1,"flex","justify-between","items-start","mb-4"],[1,"h-5","w-32","bg-bg-secondary","rounded"],[1,"h-6","w-16","bg-bg-secondary","rounded-full"],[1,"w-10","h-10","bg-bg-secondary","rounded-lg"],[1,"flex-1"],[1,"h-4","w-24","bg-bg-secondary","rounded","mb-2"],[1,"h-3","w-32","bg-bg-secondary","rounded"],[1,"w-20","h-20","rounded-2xl","bg-bg-card","flex","items-center","justify-center","mb-6"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5",1,"w-10","h-10","text-text-muted"],["x","4","y","2","width","16","height","20","rx","2"],["cx","12","cy","14","r","4"],["x1","12","y1","6","x2","12","y2","6.01"],[1,"text-xl","font-bold","mb-2"],[1,"text-text-secondary","mb-6","max-w-sm"],[1,"flex","items-center","gap-2","px-5","py-2.5","bg-accent-qobuz","text-white","rounded-lg","font-medium","hover:bg-accent-qobuz/90","transition-colors",3,"click"],[1,"text-left","bg-bg-card","border","rounded-xl","overflow-hidden","transition-all","hover:bg-bg-card-hover","group",3,"border-accent-qobuz","border-border-subtle","ring-1","ring-accent-qobuz","border-l-4","border-l-green-500","border-l-blue-500","border-l-transparent"],[1,"mt-6","bg-bg-card","border","border-border-subtle","rounded-xl","overflow-hidden"],[1,"text-left","bg-bg-card","border","rounded-xl","overflow-hidden","transition-all","hover:bg-bg-card-hover","group",3,"click"],[1,"p-4"],[1,"flex","justify-between","items-start","mb-3"],[1,"font-semibold","text-text-primary","truncate","pr-2"],[1,"flex","items-center","gap-1","px-2","py-0.5","rounded-full","text-xs","font-medium","shrink-0"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"w-3","h-3",3,"innerHTML"],[1,"w-10","h-10","rounded-lg","bg-bg-secondary","flex","items-center","justify-center","shrink-0"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"w-5","h-5","text-text-secondary"],[1,"flex-1","min-w-0"],[1,"text-sm","text-text-primary","truncate"],[1,"px-1.5","py-0.5","bg-white/10","rounded","text-[10px]","font-semibold","uppercase","text-text-secondary"],[1,"flex","items-center","gap-2","text-xs","text-text-muted"],[1,"w-4","h-4","bg-blue-500","text-white","rounded","text-[10px]","font-bold","flex","items-center","justify-center"],[1,"mt-3","pl-13"],[1,"flex","items-center","gap-2","text-text-muted","text-xs"],[1,"px-4","py-2","bg-accent-qobuz/10","border-t","border-accent-qobuz/20"],["x","4","y","6","width","6","height","12","rx","1"],["x","14","y","6","width","6","height","12","rx","1"],["x","6","y","4","width","12","height","16","rx","2"],["cx","12","cy","14","r","3"],["cx","12","cy","7","r","1"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"w-4","h-4","opacity-60"],["x","3","y","11","width","5","height","8","rx","1"],["d","M8 15l4-4v8l-4-4z"],["d","M16 12a4 4 0 0 1 0 6"],[1,"flex","items-center","gap-2",3,"click"],[1,"w-7","h-7","rounded-full","bg-bg-secondary","border","border-border-accent","flex","items-center","justify-center","text-text-secondary","hover:text-text-primary","hover:border-blue-500","transition-colors",3,"click"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"w-3.5","h-3.5"],["x1","5","y1","12","x2","19","y2","12"],[1,"flex-1","max-w-[120px]","h-1","bg-bg-secondary","rounded-full","overflow-hidden"],[1,"h-full","bg-gradient-to-r","from-green-500","to-green-400","rounded-full","transition-all"],[1,"w-7","h-7","rounded-full","bg-bg-secondary","border","border-border-accent","flex","items-center","justify-center","text-text-secondary","hover:text-text-primary","hover:border-green-500","transition-colors",3,"click"],["x1","12","y1","5","x2","12","y2","19"],[1,"text-xs","text-text-muted","w-8","text-right"],[1,"flex","items-center","gap-2","text-accent-qobuz","text-xs","font-medium"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["d","M22 11.08V12a10 10 0 1 1-5.93-9.14"],["points","22 4 12 14.01 9 11.01"],[1,"flex","items-center","justify-between","px-4","py-3","border-b","border-border-subtle"],[1,"font-semibold"],[1,"px-2.5","py-1","bg-green-500/10","text-green-500","rounded-full","text-xs","font-medium"],[1,"flex","gap-4"],[1,"w-24","h-24","sm:w-32","sm:h-32","bg-bg-secondary","rounded-lg","flex-shrink-0","overflow-hidden"],[1,"w-full","h-full","object-cover",3,"src"],[1,"w-full","h-full","flex","items-center","justify-center","text-text-muted"],[1,"font-semibold","text-text-primary","truncate","mb-1"],[1,"text-sm","text-text-secondary","truncate","mb-0.5"],[1,"text-xs","text-text-muted","truncate","mb-3"],[1,"mb-4"],[1,"w-10","h-10","rounded-full","bg-bg-secondary","border","border-border-accent","flex","items-center","justify-center","text-text-secondary","hover:text-text-primary","hover:border-text-muted","transition-colors",3,"click"],["viewBox","0 0 24 24","fill","currentColor",1,"w-5","h-5"],["d","M6 6h2v12H6zm3.5 6l8.5 6V6z"],[1,"w-12","h-12","rounded-full","bg-green-500","flex","items-center","justify-center","text-white","hover:bg-green-600","transition-colors",3,"click"],["viewBox","0 0 24 24","fill","currentColor",1,"w-6","h-6"],["d","M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"],[1,"mt-3","text-[10px]","text-text-muted","uppercase","tracking-wider"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5",1,"w-12","h-12","opacity-50"],["cx","12","cy","12","r","10"],[1,"h-1","bg-bg-secondary","rounded-full","overflow-hidden","mb-1.5"],[1,"flex","justify-between","text-[10px]","text-text-muted","tabular-nums"],["d","M6 19h4V5H6v14zm8-14v14h4V5h-4z"],["d","M8 5v14l11-7z"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"a",4),m(),t(5,"svg",5),s(6,"path",6),n()(),x(),t(7,"div",7),m(),t(8,"svg",8),s(9,"rect",9)(10,"circle",10)(11,"path",11),n(),x(),t(12,"h1",12),l(13,"Players"),n()()(),t(14,"div",13)(15,"button",14),g("click",function(){return o.refreshPlayers()}),m(),t(16,"svg",15),s(17,"path",16)(18,"path",17),n(),x(),t(19,"span",18),l(20,"Aktualisieren"),n()(),p(21,J,2,1,"button",19),n()()(),t(22,"main",20),p(23,X,6,2,"div",21),p(24,Z,7,1)(25,ee,15,0,"div",22)(26,ye,4,1),n()()),e&2&&(a(15),w("disabled",o.isLoading()),a(),T("animate-spin",o.isLoading()),a(5),u(o.auth.isLoggedIn()?21:-1),a(2),u(!o.isLoading()&&o.players().length>0?23:-1),a(),u(o.isLoading()?24:o.players().length===0?25:26))},dependencies:[D,N],styles:[".safe-area-top[_ngcontent-%COMP%]{padding-top:env(safe-area-inset-top,0)}.pl-13[_ngcontent-%COMP%]{padding-left:3.25rem}"]})};export{K as PlayersComponent};
