import{b as te,c as ne,e as re,f as oe,g as ie}from"./chunk-KFW5HDWR.js";import"./chunk-NX6VWMXW.js";import{a as ee}from"./chunk-OCLKLVYL.js";import{a as O}from"./chunk-VWKT4AXU.js";import{h as se}from"./chunk-OI2BH5VR.js";import"./chunk-E6U5HHN4.js";import"./chunk-IFTFUA44.js";import{a as $,d as X,h as Y,i as J,j as q,l as P}from"./chunk-Y2DN57ZN.js";import{$ as V,$a as z,B as m,H as d,I as F,J as j,K as h,L as x,N as y,Q as L,Qb as K,R as D,S as a,T as W,Va as G,a as _,bb as R,e as C,ea as H,ec as Z,f,fc as Q,ha as B,ia as I,jb as k,kb as A,lb as E,o as u,v as U,w as l,x as g}from"./chunk-AT7XICDW.js";var ae=[{path:"",loadComponent:()=>import("./chunk-UAFTAVXX.js").then(e=>e.HomeComponent)},{path:"qobuz",loadChildren:()=>import("./chunk-RIR6TH64.js").then(e=>e.QOBUZ_ROUTES)},{path:"tunein",loadComponent:()=>import("./chunk-7YHKXJRN.js").then(e=>e.TuneInComponent)},{path:"radioparadise",loadComponent:()=>import("./chunk-LHGVT4IA.js").then(e=>e.RadioParadiseComponent)},{path:"players",loadComponent:()=>import("./chunk-HOVF6QXO.js").then(e=>e.PlayersComponent)},{path:"settings",loadComponent:()=>import("./chunk-4PZ47OD7.js").then(e=>e.SettingsComponent)},{path:"**",redirectTo:""}];var pe=(e,n)=>{if(!e.url.includes("/Qobuz")&&!e.url.includes("/api/qobuz"))return n(e);let o=a(P).getAuthHeaders();if(!o["X-Auth-Token"]||e.headers.has("X-Auth-Token"))return n(e);let t=e.clone({setHeaders:o});return n(t)};var N="Service workers are disabled or not supported by this browser",b=class{serviceWorker;worker;registration;events;constructor(n,r){if(this.serviceWorker=n,!n)this.worker=this.events=this.registration=new C(o=>o.error(new h(5601,!1)));else{let o=null,t=new f;this.worker=new C(p=>(o!==null&&p.next(o),t.subscribe(S=>p.next(S))));let s=()=>{let{controller:p}=n;p!==null&&(o=p,t.next(o))};n.addEventListener("controllerchange",s),s(),this.registration=this.worker.pipe(d(()=>n.getRegistration().then(p=>{if(!p)throw new h(5601,!1);return p})));let i=new f;this.events=i.asObservable();let c=p=>{let{data:S}=p;S?.type&&i.next(S)};n.addEventListener("message",c),r?.get(R,null,{optional:!0})?.onDestroy(()=>{n.removeEventListener("controllerchange",s),n.removeEventListener("message",c)})}}postMessage(n,r){return new Promise(o=>{this.worker.pipe(m(1)).subscribe(t=>{t.postMessage(_({action:n},r)),o()})})}postMessageWithOperation(n,r,o){let t=this.waitForOperationCompleted(o),s=this.postMessage(n,r);return Promise.all([s,t]).then(([,i])=>i)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(n){let r;return typeof n=="string"?r=o=>o.type===n:r=o=>n.includes(o.type),this.events.pipe(g(r))}nextEventOfType(n){return this.eventsOfType(n).pipe(m(1))}waitForOperationCompleted(n){return new Promise((r,o)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(g(t=>t.nonce===n),m(1),u(t=>{if(t.result!==void 0)return t.result;throw new Error(t.error)})).subscribe({next:r,error:o})})}get isEnabled(){return!!this.serviceWorker}},fe=(()=>{class e{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new f;constructor(r){if(this.sw=r,!r.isEnabled){this.messages=l,this.notificationClicks=l,this.notificationCloses=l,this.pushSubscriptionChanges=l,this.subscription=l;return}this.messages=this.sw.eventsOfType("PUSH").pipe(u(t=>t.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(u(t=>t.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(u(t=>t.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(u(t=>t.data)),this.pushManager=this.sw.registration.pipe(u(t=>t.pushManager));let o=this.pushManager.pipe(d(t=>t.getSubscription()));this.subscription=new C(t=>{let s=o.subscribe(t),i=this.subscriptionChanges.subscribe(t);return()=>{s.unsubscribe(),i.unsubscribe()}})}requestSubscription(r){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(N));let o={userVisibleOnly:!0},t=this.decodeBase64(r.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),s=new Uint8Array(new ArrayBuffer(t.length));for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return o.applicationServerKey=s,new Promise((i,c)=>{this.pushManager.pipe(d(v=>v.subscribe(o)),m(1)).subscribe({next:v=>{this.subscriptionChanges.next(v),i(v)},error:c})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(N));let r=o=>{if(o===null)throw new h(5602,!1);return o.unsubscribe().then(t=>{if(!t)throw new h(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((o,t)=>{this.subscription.pipe(m(1),d(r)).subscribe({next:o,error:t})})}decodeBase64(r){return atob(r)}static \u0275fac=function(o){return new(o||e)(D(b))};static \u0275prov=y({token:e,factory:e.\u0275fac})}return e})(),ge=(()=>{class e{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(r){if(this.sw=r,!r.isEnabled){this.versionUpdates=l,this.unrecoverable=l;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(N));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let r=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:r},r).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new h(5601,!1));let r=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:r},r)}static \u0275fac=function(o){return new(o||e)(D(b))};static \u0275prov=y({token:e,factory:e.\u0275fac})}return e})(),ue=new L("");function me(){let e=a(w);if(!("serviceWorker"in navigator&&e.enabled!==!1))return;let n=a(ue),r=a(H),o=a(R);r.runOutsideAngular(()=>{let t=navigator.serviceWorker,s=()=>t.controller?.postMessage({action:"INITIALIZE"});t.addEventListener("controllerchange",s),o.onDestroy(()=>{t.removeEventListener("controllerchange",s)})}),r.runOutsideAngular(()=>{let t,{registrationStrategy:s}=e;if(typeof s=="function")t=new Promise(i=>s().subscribe(()=>i()));else{let[i,...c]=(s||"registerWhenStable:30000").split(":");switch(i){case"registerImmediately":t=Promise.resolve();break;case"registerWithDelay":t=le(+c[0]||0);break;case"registerWhenStable":t=Promise.race([o.whenStable(),le(+c[0])]);break;default:throw new h(5600,!1)}}t.then(()=>{o.destroyed||navigator.serviceWorker.register(n,{scope:e.scope,updateViaCache:e.updateViaCache,type:e.type}).catch(i=>console.error(x(5604,!1)))})})}function le(e){return new Promise(n=>setTimeout(n,e))}function be(){let e=a(w),n=a(V),r=!0;return new b(r&&e.enabled!==!1?navigator.serviceWorker:void 0,n)}var w=class{enabled;updateViaCache;type;scope;registrationStrategy};function de(e,n={}){return W([fe,ge,{provide:ue,useValue:e},{provide:w,useValue:n},{provide:b,useFactory:be},z(me)])}var he={providers:[B(),Y(ae,J(),q()),Z(Q([pe])),de("ngsw-worker.js",{enabled:!K(),registrationStrategy:"registerWhenStable:30000"})]};var M=class e{bluesoundApi=a(ee);playerState=a(O);destroy$=new f;pollingSubscription;POLLING_INTERVAL=1e3;isPolling=I(!1);lastPoll=I(null);startPolling(){this.stopPolling(),this.isPolling.set(!0),this.pollingSubscription=U(this.POLLING_INTERVAL).pipe(F(this.destroy$),g(()=>this.playerState.playerMode()==="bluesound"),g(()=>!!this.playerState.selectedPlayer()),d(()=>{let n=this.playerState.selectedPlayer();return n?this.bluesoundApi.getStatus(n.ipAddress):[]}),j(()=>this.lastPoll.set(new Date))).subscribe(n=>{n&&this.playerState.updatePlaybackStatus(n)})}stopPolling(){this.pollingSubscription&&(this.pollingSubscription.unsubscribe(),this.pollingSubscription=void 0),this.isPolling.set(!1)}pollOnce(){let n=this.playerState.selectedPlayer();n&&this.bluesoundApi.getStatus(n.ipAddress).subscribe(r=>{r&&this.playerState.updatePlaybackStatus(r),this.lastPoll.set(new Date)})}refreshPlayers(){this.bluesoundApi.refreshPlayers().subscribe(n=>{this.playerState.players.set(n)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.stopPolling()}static \u0275fac=function(r){return new(r||e)};static \u0275prov=y({token:e,factory:e.\u0275fac,providedIn:"root"})};var T=class e{auth=a(P);playerState=a(O);polling=a(M);ngOnInit(){this.auth.authToken()&&this.auth.verifyToken().subscribe()}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=G({type:e,selectors:[["app-root"]],decls:9,vars:0,consts:[[1,"app-container","min-h-screen","bg-bg-primary"],[1,"flex-1","pb-24","overflow-y-auto"]],template:function(r,o){r&1&&(k(0,"div",0),E(1,"app-hamburger-menu"),k(2,"main",1),E(3,"router-outlet"),A(),E(4,"app-global-player")(5,"app-now-playing-popup")(6,"app-fab-menu")(7,"app-volume-panel")(8,"app-global-context-menu"),A())},dependencies:[X,te,ne,re,oe,ie,se],styles:[".app-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;height:100dvh;overflow:hidden}main[_ngcontent-%COMP%]{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch}"]})};$(T,he).catch(e=>console.error(e));
